<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <title>网页录制应用</title>
  <style>
    /* 在这里添加CSS样式 */
  </style>
</head>

<body>
  <h1>网页录制工具</h1>
  <button id="startBtn">开始录制</button>
  <button id="stopBtn" disabled>停止录制</button>
  <p id="status">准备录制</p>
  <video id="recordingVideo" autoplay></video>

  <script>
    document.getElementById('startBtn').addEventListener('click', function () {
      navigator.mediaDevices.getDisplayMedia({ video: true, audio: true}).then(stream => {
        document.getElementById('status').innerText = '录制中';
        document.getElementById('startBtn').disabled = true;
        document.getElementById('stopBtn').disabled = false;

        const video = document.getElementById('recordingVideo');
        video.srcObject = stream;

        const mediaRecorder = new MediaRecorder(stream);
        let chunks = [];

        mediaRecorder.ondataavailable = function (e) {
          chunks.push(e.data);
        };

        mediaRecorder.onstop = function () {
          const blob = new Blob(chunks, { 'type': 'video/webm' });
          // 在这里可以添加将视频保存到本地或上传到服务器的代码
          const url = URL.createObjectURL(blob);
          // 创建一个a元素用于下载
          const a = document.createElement('a');
          a.href = url;
          a.download = 'recording.webm';  // 设置下载文件的名称
          document.body.appendChild(a);
          a.click();
          // 清理并移除a元素
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
        };

        mediaRecorder.start();

        document.getElementById('stopBtn').addEventListener('click', function () {
          mediaRecorder.stop();
          document.getElementById('status').innerText = '停止录制';
          document.getElementById('startBtn').disabled = false;
          document.getElementById('stopBtn').disabled = true;
          stream.getVideoTracks().forEach(track => track.stop());
        });
      });
    });

  </script>
</body>

</html>